## å‰è¨€

ä¸‹é¢ä¼šä»‹ç»æˆ‘åœ¨å·¥ä½œä¸­æ˜¯å¦‚ä½•é…ç½® webpack æ¥åšåˆ°æŒä¹…åŒ–ç¼“å­˜çš„

å¯ä»¥å…ˆå‚è€ƒä¸‹[å‰ç«¯å¼€å‘éƒ¨ç½²](https://www.zhihu.com/question/20790576/answer/32602154)

### å‰ç«¯é¡¹ç›®ä¸­å¦‚ä½•ä¸Šçº¿

- ä¸Šçº¿å‰æˆ‘ä»¬å¼€çš„ jsã€css
- ä¸Šçº¿æ—¶å€™æœºå™¨ä¸Šä¿å­˜äº†ä¸€ä¸ª html å¼•å…¥ js css
- æ¯æ¬¡çš„å˜æ›´åªéœ€è¦æ›´æ–°æˆ‘ä»¬ jsã€css åœ°å€å³å¯

### é‡åˆ°çš„é—®é¢˜

#### å¦‚ä½•ä¿è¯åœ¨ jsã€css åœ¨éƒ¨ç½²æ—¶å€™, è€ç”¨æˆ·ç¨³å®šæ€§ã€ æ–°ç”¨æˆ·çœ‹åˆ°æœ€æ–°é¡µé¢

- å¯¹ jsã€css ç­‰æ–‡ä»¶å¼€å¯ç¼“å­˜
- å¯¹ js ã€css ç­‰æ–‡ä»¶é€šè¿‡å”¯ä¸€çš„è·¯å¾„åœ°å€ä¿è¯èµ„æºæ˜¯å¢é‡çš„
- å…ˆä¸Šçº¿ jsã€css è¿™äº›æ–‡ä»¶, åœ¨ä¸Šä¼  html ä¿è¯æ–°è€ç”¨æˆ·çš„ç¨³å®šæ€§

æ€»ä¹‹å°±æ˜¯è¦ä¿è¯æˆ‘ä»¬ jsã€css è¿™äº›èµ„æºæ˜¯å”¯ä¸€çš„,å¯ä»¥ç¼“å­˜çš„

## webpack å¦‚ä½•åšæŒä¹…åŒ–ç¼“å­˜

### ç©æ³•ï¼ˆhash æ–‡ä»¶åï¼‰

- jsã€css æ‰“åŒ…åçš„èµ„æºåœ°å€æ˜¯å”¯ä¸€çš„
- æ˜¯ç¨³å®šçš„ï¼Œåªæ‰“åŒ…å½“å‰æ›´æ–°æ¨¡å—

### hash åˆ†ç±»

- hash æ–¹å¼ï¼šé€šè¿‡ webpack åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ç”Ÿæˆå”¯ä¸€ hash å€¼,ä»»æ„æ–‡ä»¶çš„å˜æ¢éƒ½ä¼šé‡æ–°ç”Ÿæˆ
- chunkhash æ–¹å¼ï¼šæ ¹æ®æ¨¡å—è®¡ç®—çš„ hash å€¼ï¼Œåªå¯¹æŸä¸ªæ–‡ä»¶çš„æ”¹åŠ¨æ¥ç”Ÿæˆ hash å€¼

### ä¸Šä¸€æ®µ config.js é…ç½®

```js
const path = require("path");
const HtmlWebpackPlugin = require("html-webpack-plugin");
module.exports = {
  entry: path.resolve(__dirname, "../src/index.js"),
  output: {
    filename: "[name].[chunkhash:8].js",
    path: path.resolve(__dirname, "../dist"),
  },
  plugins: [new HtmlWebpackPlugin()],
};
```

### éªŒè¯è¿‡ç¨‹

#### åŸºæœ¬ç”¨æ³•

- å…¥å£

```js
console.log("å…¥å£");
// æ›´æ–°

console.log("å…¥å£11");
```

- æ‰“åŒ…ç»“æœ(main.b2ce5bb9e246f093f9eb.js)
  ![](https://user-images.githubusercontent.com/21278158/184530357-f4028f27-c92b-4f89-9bf7-1bbbbfd3de67.png)
- æ›´æ–°ç»“æœ(main.3b628179ae3dbd2e4284.js)
  ![](https://user-images.githubusercontent.com/21278158/184530424-aa294ce7-7d80-4bf5-bea7-f45ff7a9a45d.png)

#### åˆ†ç¦»ç¬¬ä¸‰åº“ã€è‡ªå®šä¹‰æ¨¡å—

- å…¥å£

```js
// one.js
import React from "react";
console.log(React);

export const greeter = function () {
  var greet = document.createElement("div");
  greet.textContent = "one";
  // æ›´æ–°
  // greet.textContent = "one11111";
  return greet;
};

// two.js
import React from "react";
console.log(React);

export const greeter = function () {
  var greet = document.createElement("div");
  greet.textContent = "two";
  return greet;
};

// index.js
function getComponent() {
  return import("lodash").then((_) => {
    var element = document.createElement("div");
    element.innerHTML = _.join(["Hello", "webpack"], " ");
    return element;
  });
}

getComponent().then((component) => {
  document.body.appendChild(component);
});

import("./one").then((module) => {
  const greeter = module.default;
});
import("./two").then((module) => {
  const greeter = module.default;
});
```

- æ‰“åŒ…ç»“æœ
  ![](https://user-images.githubusercontent.com/21278158/184539350-52d8ccec-fbe1-4491-a12f-3e0e7b30e991.png)
- æ›´æ–°ç»“æœ
  ![](https://user-images.githubusercontent.com/21278158/184539371-e96d323f-d8e3-49e7-90e8-3dc530707a02.png)

å€ŸåŠ© webpack çš„ splitChunk åšåˆ°

- æŠ½ç¦»å…¬å…±çš„æ¨¡å—
- æŠ½ç¦»ç¬¬ä¸‰æ–¹æ¨¡å—
- å¼‚æ­¥åŠ è½½çš„æ¨¡å—

#### å½±å“ chunkhash å€¼å˜æ¢åŸå› 

- æ›´æ”¹æŸä¸ªæ¨¡å—äº† chunkhash æ‰ä¼šå˜æ¢
- webpack è¿è¡Œçš„ runtime ä»£ç 

#### css çš„ç¼“å­˜

- CSS æ ·å¼å•ç‹¬æŠ½ç¦»ç”Ÿæˆæ–‡ä»¶
- MiniCssExtractPlugin

  **æœ‰ä¸ªæ³¨æ„ç‚¹**

  - åªæ”¹å˜ CSS æ–‡ä»¶ï¼Œä¼šå‘ç°å¯¹åº”çš„ entry JS å’Œ CSS æ–‡ä»¶çš„ chunkhash éƒ½ä¼šæ”¹å˜
  - CSS æ–‡ä»¶å°†ä½¿ç”¨ contenthashï¼Œä»¥åŒºåˆ† CSS æ–‡ä»¶å’Œ JS æ–‡ä»¶çš„æ›´æ–°

## å°ç»“

ä»¥ä¸Šå†™çš„ä¸å¤ªç¾è§‚çš„åœ°æ–¹ï¼Œå¤§å®¶å¤šè§è°…

ğŸ‘‡ğŸ» å®é™…å¼€å‘ä¸­æˆ‘ä»¬ç†æƒ³ç¼“å­˜ç­–ç•¥

- æŠ½ç¦» runtime ä¿è¯ chunkhash ä¸ä¼šå½±å“
- ä½¿ç”¨ contenthash æŠ½ç¦» css æ–‡ä»¶
- è®¾ç½® namedChunks
- gif|png|jpe?g|eot|woff|ttf|svg|pdf ç­‰ä½¿ç”¨ hash
